% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/import_xlsx.R
\name{import_xlsx}
\alias{import_xlsx}
\title{Import Data from Excel Files}
\usage{
import_xlsx(file, rbind = TRUE, sheet = NULL, ...)
}
\arguments{
\item{file}{A character vector of file paths. The Excel files to be imported.
All paths must point to existing .xlsx or .xls files.}

\item{rbind}{A logical value. If TRUE and multiple files/sheets are provided,
combines all data into a single data.table. If FALSE, returns a list of
data.tables. Default is TRUE.}

\item{sheet}{A numeric vector or NULL. Specifies which sheets to read from each file:
\itemize{
\item If NULL (default), reads all sheets.
\item If numeric, reads only the specified sheet indices.
}}

\item{...}{Additional arguments passed to \code{\link[readxl:read_excel]{readxl::read_excel()}}, such as
col_types, skip, or na.}
}
\value{
Depends on the \code{rbind} parameter:
\itemize{
\item If rbind = TRUE: A single data.table containing all imported data with
two additional columns:
\itemize{
\item excel_name: The source file name (without extension)
\item sheet_name: The source sheet name
}
\item If rbind = FALSE: A named list of data.tables, where each element is named
as "filename_sheetname" and contains the data from that specific sheet.
}
}
\description{
The \code{import_xlsx} function provides a flexible way to import data from one or multiple
Excel files, with options to specify sheets and combine or separate the imported data.
It handles multiple files and sheets, with automatic source tracking.
}
\details{
The function provides a comprehensive solution for importing Excel data with the
following features:
\itemize{
\item Supports multiple files and sheets
\item Automatic source tracking for files and sheets
\item Flexible combining options
\item Handles missing columns across sheets when combining
\item Preserves original data types through readxl
}
}
\note{
\itemize{
\item All specified files must exist and be accessible Excel files
\item Sheet indices must be valid across all input files
\item When rbind = TRUE, the function assumes compatible data structures
across sheets and files
\item Missing columns across sheets are filled with NA when combining
\item File names in source tracking columns have their extensions removed
}
}
\examples{
xlsx_files <- mintyr_example(mintyr_examples("xlsx_test"))
xlsx_files
import_xlsx(xlsx_files)
}
\seealso{
\code{\link[readxl:read_excel]{readxl::read_excel()}}
}
