<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The import_xlsx function reads data from Excel files, optionally from specified sheets, and can either merge data from multiple files or keep them separate."><title>Import list of xlsx sheets — import_xlsx • mintyr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import list of xlsx sheets — import_xlsx"><meta property="og:description" content="The import_xlsx function reads data from Excel files, optionally from specified sheets, and can either merge data from multiple files or keep them separate."><meta property="og:image" content="https://tony2015116.github.io/mintyr/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mintyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/get-started.html">Get started</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tony2015116/mintyr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Import list of xlsx sheets</h1>
      <small class="dont-index">Source: <a href="https://github.com/tony2015116/mintyr/blob/HEAD/R/import_xlsx.R" class="external-link"><code>R/import_xlsx.R</code></a></small>
      <div class="d-none name"><code>import_xlsx.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>import_xlsx</code> function reads data from Excel files, optionally from specified sheets, and can either merge data from multiple files or keep them separate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">import_xlsx</span><span class="op">(</span><span class="va">file</span>, rbind <span class="op">=</span> <span class="cn">TRUE</span>, sheet <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file</dt>
<dd><p>character vector of file paths. Paths to the Excel files to be imported. These paths must point to existing files.</p></dd>


<dt>rbind</dt>
<dd><p>logical, optional. If TRUE and more than one file is specified, it binds rows from different files into one dataset. Default is TRUE. Note: For <code>vroom</code>, row binding is inherent and cannot be turned off.</p></dd>


<dt>sheet</dt>
<dd><p>numeric vector or NULL, optional. Specifies the sheets to be read from each file. If NULL, all sheets are read. If numeric, only the specified sheets (by index) are read. Default is NULL.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the <code><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel()</a></code> function, such as col_types to specify column data types.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Depending on the <code>rbind</code> parameter:</p><ul><li><p>If <code>rbind</code> is TRUE, returns a single <code>data.table</code> combining all files and sheets, with an additional 'excel_name' column indicating the source file.</p></li>
<li><p>If <code>rbind</code> is FALSE, returns a named list of <code>data.tables</code>, each representing data from a sheet, named by combining the file and sheet names.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Make sure that the <code>file</code> paths provided are valid and exist. The function will stop with an error if any file does not exist or if the sheet indices are out of range.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xlsx_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="mintyr_example.html">mintyr_example</a></span><span class="op">(</span><span class="fu"><a href="mintyr_examples.html">mintyr_examples</a></span><span class="op">(</span><span class="st">"xlsx_test"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xlsx_files</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/home/runner/work/_temp/Library/mintyr/extdata/xlsx_test1.xlsx"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "/home/runner/work/_temp/Library/mintyr/extdata/xlsx_test2.xlsx"</span>
<span class="r-in"><span><span class="fu">import_xlsx</span><span class="op">(</span><span class="va">xlsx_files</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     excel_name sheet_name  col1   col2   col3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt;     &lt;char&gt; &lt;num&gt; &lt;char&gt; &lt;lgcl&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: xlsx_test1     Sheet1     4      d  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: xlsx_test1     Sheet1     5      f   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: xlsx_test1     Sheet1     6      e   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: xlsx_test1     Sheet2     1      a   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: xlsx_test1     Sheet2     2      b  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: xlsx_test1     Sheet2     3      c   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: xlsx_test2     Sheet1    15      o  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: xlsx_test2     Sheet1    16      p   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: xlsx_test2     Sheet1    17      q  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: xlsx_test2          a     7      g  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: xlsx_test2          a     9      h   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: xlsx_test2          a     8      i  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: xlsx_test2          b    10      J  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: xlsx_test2          b    11      K   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: xlsx_test2          b    12      L  FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Guo Meng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

